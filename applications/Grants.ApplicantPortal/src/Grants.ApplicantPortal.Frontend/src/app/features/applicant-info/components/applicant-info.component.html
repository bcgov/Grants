<div class="applicant-info-content">
  <div class="app-info">
    <span class="app-id">{{ applicantInfo?.id }}</span>
    <span class="app-name">{{ applicantInfo?.organization }}</span>
  </div>

  <div class="content-grid">
    <!-- Organization Information -->
    <div class="card">
      <div class="card-header d-flex align-items-center">
        <div class="flex-grow-1">
          <h3 class="mb-0">Organization Information</h3>
        </div>
        <div>
          <button
            class="btn btn-primary btn-floating"
            (click)="saveOrganization()"
          >
            Save
          </button>
        </div>
      </div>
      <div class="card-body">
        <div class="container-fluid form-section">
          <div class="row">
            <div class="col-md-12">
              <div class="field">
                <!-- <label for="orgSearch">Org Book Search</label>
                <input
                  id="orgSearch"
                  type="text"
                  [value]="organizationInfo?.orgName"
                  class="form-control"
                /> -->

                <label for="orgSearch">Organization Book Search</label>
                <div class="search-container">
                  <div class="input-group">
                    <input
                      id="orgSearch"
                      type="text"
                      [(ngModel)]="searchTerm"
                      (input)="onSearchInput($event)"
                      (focus)="onSearchFocus()"
                      (blur)="onSearchBlur()"
                      class="form-control"
                      placeholder="Type at least 3 characters to search registered name..."
                      autocomplete="off"
                    />
                    <div class="ap-spinner" *ngIf="isSearching">
                      <div class="spinner-border spinner-border-sm float-end">
                        <span class="sr-only">Loading...</span>
                      </div>
                    </div>
                    <!-- *ngIf="isSearching"-->
                    <!-- <div class="input-group-append">
                     
                      <span class="input-group-text">
                        <div
                          class="spinner-border spinner-border-sm"
                          role="status"
                        >
                          <span class="sr-only">Loading...</span>
                        </div>
                      </span>
                    </div> -->
                  </div>

                  <!-- Search Results Dropdown -->
                  <div
                    class="search-dropdown"
                    *ngIf="showDropdown && searchResults.length > 0"
                  >
                    <div
                      class="search-result-item"
                      *ngFor="let result of searchResults"
                      (click)="onSearchResultSelect(result)"
                    >
                      <div class="result-name">{{ result.name }}</div>
                      <div class="result-details">
                        <span class="reg-number">{{
                          result.registeredNumber
                        }}</span>
                        <span
                          class="status"
                          [class.active]="result.status === 'Active'"
                          >{{ result.status }}</span
                        >
                        <span class="type">{{ result.type }}</span>
                      </div>
                    </div>
                  </div>

                  <!-- No Results Message -->
                  <div
                    class="search-dropdown"
                    *ngIf="
                      showDropdown &&
                      searchResults.length === 0 &&
                      searchTerm.length >= 3 &&
                      !isSearching
                    "
                  >
                    <div class="no-results">No organizations found</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="field">
                <label for="orgName">Registered Organization Name</label>
                <input
                  id="orgName"
                  type="text"
                  [value]="organizationInfo?.orgName"
                  disabled
                  class="form-control"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="field">
                <label for="regNumber">Registered Organization Number</label>
                <input
                  id="regNumber"
                  type="text"
                  [value]="organizationInfo?.orgRegisteredNumber"
                  disabled
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="field">
                <label for="orgStatus">Organization Book Status</label>
                <input
                  id="orgStatus"
                  [value]="organizationInfo?.orgStatus"
                  disabled
                  class="form-control"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="field">
                <label for="orgType">Organization Type</label>
                <input
                  id="orgType"
                  type="text"
                  [value]="
                    organizationInfo?.orgType
                      ? organizationInfo?.orgType
                      : 'N/A'
                  "
                  disabled
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-8">
              <div class="field">
                <label for="nonRegOrgName"
                  >Non-Registered Organization Name</label
                >
                <input
                  id="nonRegOrgName"
                  type="text"
                  [value]="organizationInfo?.nonRegOrgName"
                  class="form-control"
                />
              </div>
            </div>
            <div class="col-md-4">
              <div class="field">
                <label for="orgSize">Organization Size</label>
                <input
                  id="orgSize"
                  type="text"
                  [value]="organizationInfo?.orgSize"
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="field">
                <label for="fiscalYearEndMonth">Fiscal Year End Month</label>
                <select
                  class="form-select"
                  id="fiscalYearEndMonth"
                  [(ngModel)]="selectedFiscalMonth"
                  (change)="onFiscalMonthChange($event)"
                >
                  <option selected>Select Month</option>
                  <option value="Jan">January</option>
                  <option value="Feb">February</option>
                  <option value="Mar">March</option>
                  <option value="Apr">April</option>
                  <option value="May">May</option>
                  <option value="Jun">June</option>
                  <option value="Jul">July</option>
                  <option value="Aug">August</option>
                  <option value="Sep">September</option>
                  <option value="Oct">October</option>
                  <option value="Nov">November</option>
                  <option value="Dec">December</option>
                </select>
              </div>
            </div>
            <div class="col-md-6">
              <div class="field">
                <label for="fiscalYearEndDay">Fiscal Year End Day</label>
                <select
                  class="form-select"
                  id="fiscalYearEndDay"
                  [(ngModel)]="selectedFiscalDay"
                >
                  <option selected>Select Day</option>
                  <option
                    *ngFor="let day of [].constructor(31); let i = index"
                    [value]="i + 1"
                  >
                    {{ i + 1 }}
                  </option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header d-flex align-items-center">
        <div>
          <h3 class="mb-0 ap-pad-10">Submissions</h3>
        </div>
      </div>
      <div class="card-body">
        <app-submissions [submissions]="submissions"></app-submissions>
      </div>
    </div>
  </div>

  <div class="content-grid">
    <div class="card">
      <div class="card-header d-flex align-items-center">
        <div>
          <h3 class="mb-0 ap-pad-10">Contact Information</h3>
        </div>
      </div>
      <div class="card-body">
        &nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />&nbsp;<br />
      </div>
    </div>

    <div class="card">
      <div class="card-header d-flex align-items-center">
        <div>
          <h3 class="mb-0 ap-pad-10">Address Information</h3>
        </div>
      </div>
      <div class="card-body"></div>
    </div>
  </div>
</div>
